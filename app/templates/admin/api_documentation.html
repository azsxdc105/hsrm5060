{% extends "base.html" %}

{% block title %}API Documentation{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="h3 mb-0">
                    <i class="fas fa-code me-2"></i>
                    API Documentation
                </h1>
                <a href="{{ url_for('admin.index') }}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left me-2"></i>
                    العودة للوحة التحكم
                </a>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-3">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">API Sections</h5>
                </div>
                <div class="list-group list-group-flush">
                    <a href="#authentication" class="list-group-item list-group-item-action">
                        <i class="fas fa-key me-2"></i>Authentication
                    </a>
                    <a href="#claims" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-alt me-2"></i>Claims
                    </a>
                    <a href="#companies" class="list-group-item list-group-item-action">
                        <i class="fas fa-building me-2"></i>Companies
                    </a>
                    <a href="#users" class="list-group-item list-group-item-action">
                        <i class="fas fa-users me-2"></i>Users
                    </a>
                    <a href="#reports" class="list-group-item list-group-item-action">
                        <i class="fas fa-chart-bar me-2"></i>Reports
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-9">
            <!-- Base URL -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Base URL</h5>
                </div>
                <div class="card-body">
                    <code>{{ request.url_root }}api/v1/</code>
                </div>
            </div>

            <!-- Authentication -->
            <div id="authentication" class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-key me-2"></i>Authentication
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Login</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>POST</strong> <code>/auth/login</code>
                    </div>
                    <p><strong>Request Body:</strong></p>
                    <pre><code>{
  "email": "admin@insurance.com",
  "password": "admin123"
}</code></pre>
                    <p><strong>Response:</strong></p>
                    <pre><code>{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "user": {
    "id": 1,
    "email": "admin@insurance.com",
    "full_name": "مدير النظام",
    "role": "admin"
  }
}</code></pre>

                    <h6 class="mt-4">Refresh Token</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>POST</strong> <code>/auth/refresh</code>
                    </div>
                    <p><strong>Headers:</strong> <code>Authorization: Bearer &lt;refresh_token&gt;</code></p>
                </div>
            </div>

            <!-- Claims -->
            <div id="claims" class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-file-alt me-2"></i>Claims
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Get All Claims</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/claims</code>
                    </div>
                    <p><strong>Headers:</strong> <code>Authorization: Bearer &lt;access_token&gt;</code></p>
                    <p><strong>Query Parameters:</strong></p>
                    <ul>
                        <li><code>page</code> - Page number (default: 1)</li>
                        <li><code>per_page</code> - Items per page (default: 20)</li>
                        <li><code>status</code> - Filter by status</li>
                        <li><code>company_id</code> - Filter by company</li>
                    </ul>

                    <h6 class="mt-4">Get Single Claim</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/claims/&lt;claim_id&gt;</code>
                    </div>

                    <h6 class="mt-4">Create Claim</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>POST</strong> <code>/claims</code>
                    </div>
                    <p><strong>Request Body:</strong></p>
                    <pre><code>{
  "company_id": 1,
  "client_name": "أحمد محمد",
  "client_national_id": "1234567890",
  "policy_number": "POL123456",
  "incident_date": "2024-01-15",
  "claim_amount": 5000.00,
  "coverage_type": "comprehensive",
  "claim_details": "تفاصيل المطالبة",
  "city": "الرياض"
}</code></pre>

                    <h6 class="mt-4">Update Claim Status</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>PUT</strong> <code>/claims/&lt;claim_id&gt;/status</code>
                    </div>
                    <p><strong>Request Body:</strong></p>
                    <pre><code>{
  "status": "sent",
  "notes": "تم إرسال المطالبة بنجاح"
}</code></pre>
                </div>
            </div>

            <!-- Companies -->
            <div id="companies" class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-building me-2"></i>Companies
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Get All Companies</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/companies</code>
                    </div>

                    <h6 class="mt-4">Get Single Company</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/companies/&lt;company_id&gt;</code>
                    </div>
                </div>
            </div>

            <!-- Users -->
            <div id="users" class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-users me-2"></i>Users
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Get All Users (Admin Only)</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/users</code>
                    </div>

                    <h6 class="mt-4">Get Single User</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/users/&lt;user_id&gt;</code>
                    </div>
                </div>
            </div>

            <!-- Reports -->
            <div id="reports" class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-bar me-2"></i>Reports & Analytics
                    </h5>
                </div>
                <div class="card-body">
                    <h6>Get Reports</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/reports</code>
                    </div>

                    <h6 class="mt-4">Get Analytics</h6>
                    <div class="bg-light p-3 rounded mb-3">
                        <strong>GET</strong> <code>/analytics</code>
                    </div>
                </div>
            </div>

            <!-- Error Codes -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>Error Codes
                    </h5>
                </div>
                <div class="card-body">
                    <ul>
                        <li><strong>200</strong> - Success</li>
                        <li><strong>201</strong> - Created</li>
                        <li><strong>400</strong> - Bad Request</li>
                        <li><strong>401</strong> - Unauthorized</li>
                        <li><strong>403</strong> - Forbidden</li>
                        <li><strong>404</strong> - Not Found</li>
                        <li><strong>500</strong> - Internal Server Error</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Smooth scrolling for navigation links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
});
</script>
{% endblock %}
